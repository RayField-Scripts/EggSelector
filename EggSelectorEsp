if _G.YoshidaaGUIBuilt then return end
_G.YoshidaaGUIBuilt = true

-- SERVICES
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local CollectionService = game:GetService("CollectionService")
local RunService = game:GetService("RunService")

-- LOCAL PLAYER
local Player = Players.LocalPlayer
local PlayerGui = Player:FindFirstChildOfClass("PlayerGui") or CoreGui
local Camera = workspace.CurrentCamera

-- GUI SETUP
local ScreenGui = Instance.new("ScreenGui", PlayerGui)
ScreenGui.Name = "YoshidaaPremiumUI"
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame", ScreenGui)
Frame.AnchorPoint = Vector2.new(0.5, 0.5)
Frame.Position = UDim2.new(0.5, 0, 0.5, 0)
Frame.Size = UDim2.new(0, 300, 0, 160)
Frame.BackgroundColor3 = Color3.fromRGB(15, 0, 25)
Frame.BackgroundTransparency = 0.2
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 12)
local stroke = Instance.new("UIStroke", Frame)
stroke.Color = Color3.fromRGB(170, 0, 255)
stroke.Thickness = 2
stroke.Transparency = 0.1

local Icon = Instance.new("ImageLabel", Frame)
Icon.Image = "rbxassetid://7072718362"
Icon.Size = UDim2.new(0, 35, 0, 35)
Icon.Position = UDim2.new(0, 10, 0, 10)
Icon.BackgroundTransparency = 1

local Title = Instance.new("TextLabel", Frame)
Title.Text = "Yoshidaa Hub"
Title.Font = Enum.Font.GothamBlack
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(200, 100, 255)
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 55, 0, 12)
Title.Size = UDim2.new(1, -60, 0, 25)
Title.TextXAlignment = Enum.TextXAlignment.Left

local Tag = Instance.new("TextLabel", Frame)
Tag.Text = "Inspired by Mica"
Tag.Text ="Created by Yoshidaa"
Tag.Font = Enum.Font.Gotham
Tag.TextSize = 12
Tag.TextColor3 = Color3.fromRGB(180, 180, 180)
Tag.BackgroundTransparency = 1
Tag.Position = UDim2.new(0, 10, 1, -20)
Tag.Size = UDim2.new(1, -20, 0, 15)
Tag.TextXAlignment = Enum.TextXAlignment.Left

local Activate = Instance.new("TextButton", Frame)
Activate.Text = "Activate"
Activate.Font = Enum.Font.GothamBold
Activate.TextSize = 18
Activate.TextColor3 = Color3.fromRGB(255, 255, 255)
Activate.BackgroundColor3 = Color3.fromRGB(60, 0, 130)
Activate.Size = UDim2.new(0.8, 0, 0, 40)
Activate.Position = UDim2.new(0.1, 0, 0.5, 0)
Instance.new("UICorner", Activate).CornerRadius = UDim.new(0, 10)

-- SUCCESS PANEL
local SuccessPanel = Instance.new("Frame", ScreenGui)
SuccessPanel.Visible = false
SuccessPanel.AnchorPoint = Vector2.new(0.5, 0.5)
SuccessPanel.Position = UDim2.new(0.5, 0, 0.5, 0)
SuccessPanel.Size = UDim2.new(0, 270, 0, 110)
SuccessPanel.BackgroundColor3 = Color3.fromRGB(25, 0, 40)
SuccessPanel.BackgroundTransparency = 1
Instance.new("UICorner", SuccessPanel).CornerRadius = UDim.new(0, 12)
local successStroke = Instance.new("UIStroke", SuccessPanel)
successStroke.Color = Color3.fromRGB(120, 255, 120)
successStroke.Thickness = 1.5
successStroke.Transparency = 0.4

local Close = Instance.new("TextButton", SuccessPanel)
Close.Text = "✕"
Close.Font = Enum.Font.GothamBold
Close.TextSize = 16
Close.TextColor3 = Color3.fromRGB(255, 100, 100)
Close.BackgroundTransparency = 1
Close.Size = UDim2.new(0, 30, 0, 30)
Close.Position = UDim2.new(1, -35, 0, 5)

local SuccessText = Instance.new("TextLabel", SuccessPanel)
SuccessText.Text = "✅ Successfully Activated!"
SuccessText.Font = Enum.Font.GothamBold
SuccessText.TextSize = 16
SuccessText.TextColor3 = Color3.fromRGB(200, 255, 200)
SuccessText.BackgroundTransparency = 1
SuccessText.Size = UDim2.new(1, 0, 1, 0)
SuccessText.Position = UDim2.new(0, 0, 0, 0)

-- SOUND
local Sound = Instance.new("Sound", Frame)
Sound.SoundId = "rbxassetid://9118823107"
Sound.Volume = 1

-- ESP FUNCTION
local function runESP()
local hatchFunction = getupvalue(getupvalue(getconnections(ReplicatedStorage.GameEvents.PetEggService.OnClientEvent)[1].Function, 1), 2)
local eggModels = getupvalue(hatchFunction, 1)
local eggPets = getupvalue(hatchFunction, 2)
local espCache, activeEggs = {}, {}

local function getObjectFromId(objectId)  
	for eggModel in eggModels do  
		if eggModel:GetAttribute("OBJECT_UUID") == objectId then  
			return eggModel  
		end  
	end  
end  

local function UpdateEsp(objectId, petName)  
	local object = getObjectFromId(objectId)  
	if object and espCache[objectId] then  
		local eggName = object:GetAttribute("EggName")  
		espCache[objectId].Text = `{eggName} | {petName}`  
	end  
end  

local function AddEsp(object)  
	if object:GetAttribute("OWNER") ~= Player.Name then return end  
	local objectId = object:GetAttribute("OBJECT_UUID")  
	if not objectId then return end  

	local label = Drawing.new("Text")  
	label.Text = `{object:GetAttribute("EggName")} | {eggPets[objectId] or "?"}`  
	label.Size = 18  
	label.Color = Color3.new(1, 1, 1)  
	label.Outline = true  
	label.OutlineColor = Color3.new(0, 0, 0)  
	label.Center = true  
	label.Visible = false  

	espCache[objectId] = label  
	activeEggs[objectId] = object  
end  

local function RemoveEsp(object)  
	if object:GetAttribute("OWNER") ~= Player.Name then return end  
	local objectId = object:GetAttribute("OBJECT_UUID")  
	if espCache[objectId] then  
		espCache[objectId]:Remove()  
		espCache[objectId] = nil  
	end  
	activeEggs[objectId] = nil  
end  

local function UpdateAllEsp()  
	for objectId, object in activeEggs do  
		if not object or not object:IsDescendantOf(workspace) then  
			activeEggs[objectId] = nil  
			if espCache[objectId] then  
				espCache[objectId].Visible = false  
			end  
		else  
			local label = espCache[objectId]  
			if label then  
				local pos, onScreen = Camera:WorldToViewportPoint(object:GetPivot().Position)  
				label.Position = Vector2.new(pos.X, pos.Y)  
				label.Visible = onScreen  
			end  
		end  
	end  
end  

for _, object in CollectionService:GetTagged("PetEggServer") do  
	task.spawn(AddEsp, object)  
end  

CollectionService:GetInstanceAddedSignal("PetEggServer"):Connect(AddEsp)  
CollectionService:GetInstanceRemovedSignal("PetEggServer"):Connect(RemoveEsp)  

local old; old = hookfunction(getconnections(ReplicatedStorage.GameEvents.EggReadyToHatch_RE.OnClientEvent)[1].Function, newcclosure(function(objectId, petName)  
	UpdateEsp(objectId, petName)  
	return old(objectId, petName)  
end))  

RunService.PreRender:Connect(UpdateAllEsp)

end

-- EVENTS
Activate.MouseButton1Click:Connect(function()
Sound:Play()
TweenService:Create(SuccessPanel, TweenInfo.new(0.35), {BackgroundTransparency = 0}):Play()
SuccessPanel.Visible = true
task.delay(0.2, runESP)
end)

Close.MouseButton1Click:Connect(function()
TweenService:Create(SuccessPanel, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
task.wait(0.3)
SuccessPanel.Visible = false
end)
